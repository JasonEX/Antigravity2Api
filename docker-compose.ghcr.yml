services:
  antigravity2api:
    image: ghcr.io/jasonex/antigravity2api:latest
    container_name: antigravity2api
    ports:
      - "${AG2API_HOST:-127.0.0.1}:${AG2API_PORT:-3000}:${AG2API_PORT:-3000}"
    environment:
      AG2API_HOST: "0.0.0.0"
      AG2API_PORT: "${AG2API_PORT:-}"
      AG2API_API_KEYS: "${AG2API_API_KEYS:-}"
      AG2API_PROXY_ENABLED: "${AG2API_PROXY_ENABLED:-}"
      AG2API_PROXY_URL: "${AG2API_PROXY_URL:-}"
      AG2API_DEBUG: "${AG2API_DEBUG:-}"

      # Optional: Thought Signatures / multi-instance
      AG2API_THOUGHT_SIGNATURE_STORE_PATH: "${AG2API_THOUGHT_SIGNATURE_STORE_PATH:-}"
      AG2API_THOUGHT_SIGNATURE_DUMMY: "${AG2API_THOUGHT_SIGNATURE_DUMMY:-}"
      AG2API_THOUGHT_SIGNATURE_CACHE_MAX: "${AG2API_THOUGHT_SIGNATURE_CACHE_MAX:-}"

      # Optional: override OAuth client (otherwise uses built-in defaults)
      # GOOGLE_OAUTH_CLIENT_ID: "${GOOGLE_OAUTH_CLIENT_ID:-}"
      # GOOGLE_OAUTH_CLIENT_SECRET: "${GOOGLE_OAUTH_CLIENT_SECRET:-}"

    volumes:
      - ./auths:/app/auths
      - ./log:/app/log
      # Optional: mount a persistent state dir (useful for AG2API_THOUGHT_SIGNATURE_STORE_PATH, etc.)
      - ./state:/app/state

    restart: unless-stopped

    env_file:
      - .env
